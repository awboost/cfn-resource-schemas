{
  "$hash": "90fda7c7b9e1131812963510f5b8d46f7dc220aa",
  "$id": "aws-directconnect-privatevirtualinterface.json",
  "additionalIdentifiers": [["/properties/VirtualInterfaceId"]],
  "additionalProperties": false,
  "createOnlyProperties": [
    "/properties/AllocatePrivateVirtualInterfaceRoleArn",
    "/properties/DirectConnectGatewayId",
    "/properties/VirtualGatewayId",
    "/properties/Vlan"
  ],
  "definitions": {
    "BgpPeer": {
      "additionalProperties": false,
      "description": "Information about a BGP peer.",
      "properties": {
        "AddressFamily": {
          "description": "The address family for the BGP peer.",
          "pattern": "^(ipv4)|(ipv6)$",
          "type": "string"
        },
        "AmazonAddress": {
          "description": "The IP address assigned to the Amazon interface.",
          "pattern": "^[0-9a-fA-F:.]+/[0-9]+$",
          "type": "string"
        },
        "Asn": {
          "description": "The autonomous system (AS) number for Border Gateway Protocol (BGP) configuration.",
          "pattern": "^[1-9][0-9]*$",
          "type": "string"
        },
        "AuthKey": {
          "description": "The authentication key for BGP configuration. This string has a minimum length of 6 characters and and a maximum length of 80 characters.",
          "pattern": "^[A-Za-z0-9\\\\!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\^_`{|}~]{6,80}$",
          "type": "string"
        },
        "BgpPeerId": { "pattern": "^dxpeer-[a-z0-9]{8}$", "type": "string" },
        "CustomerAddress": {
          "description": "The IP address assigned to the customer interface.",
          "pattern": "^[0-9a-fA-F:.]+/[0-9]+$",
          "type": "string"
        }
      },
      "required": ["AddressFamily", "Asn"],
      "type": "object"
    },
    "Tag": {
      "additionalProperties": false,
      "description": "A key-value pair to associate with a resource.",
      "properties": {
        "Key": {
          "description": "The key name of the tag. You can specify a value that is 1 to 128 Unicode characters in length and cannot be prefixed with aws:. You can use any of the following characters: the set of Unicode letters, digits, whitespace, _, ., /, =, +, and -.",
          "maxLength": 128,
          "minLength": 1,
          "type": "string"
        },
        "Value": {
          "description": "The value for the tag. You can specify a value that is 0 to 256 Unicode characters in length and cannot be prefixed with aws:. You can use any of the following characters: the set of Unicode letters, digits, whitespace, _, ., /, =, +, and -.",
          "maxLength": 256,
          "minLength": 0,
          "type": "string"
        }
      },
      "required": ["Key", "Value"],
      "type": "object"
    }
  },
  "description": "Resource Type definition for AWS::DirectConnect::PrivateVirtualInterface",
  "handlers": {
    "create": {
      "permissions": [
        "directconnect:ConfirmPrivateVirtualInterface",
        "directconnect:CreateBGPPeer",
        "directconnect:CreatePrivateVirtualInterface",
        "directconnect:DescribeVirtualInterfaces",
        "directconnect:TagResource",
        "sts:AssumeRole"
      ]
    },
    "delete": {
      "permissions": [
        "directconnect:DeleteVirtualInterface",
        "directconnect:DescribeVirtualInterfaces"
      ]
    },
    "list": { "permissions": ["directconnect:DescribeVirtualInterfaces"] },
    "read": { "permissions": ["directconnect:DescribeVirtualInterfaces"] },
    "update": {
      "permissions": [
        "directconnect:AssociateVirtualInterface",
        "directconnect:CreateBGPPeer",
        "directconnect:DeleteBGPPeer",
        "directconnect:DescribeVirtualInterfaces",
        "directconnect:TagResource",
        "directconnect:UntagResource",
        "directconnect:UpdateVirtualInterfaceAttributes"
      ]
    }
  },
  "oneOf": [
    { "required": ["DirectConnectGatewayId"] },
    { "required": ["VirtualGatewayId"] }
  ],
  "primaryIdentifier": ["/properties/VirtualInterfaceArn"],
  "properties": {
    "AllocatePrivateVirtualInterfaceRoleArn": {
      "description": "The Amazon Resource Name (ARN) of the role to allocate the private virtual interface. Needs directconnect:AllocatePrivateVirtualInterface permissions and tag permissions if applicable.",
      "pattern": "^arn:aws[a-z-]*:iam::[0-9]{12}:role/.+$",
      "type": "string"
    },
    "BgpPeers": {
      "description": "The BGP peers configured on this virtual interface.",
      "insertionOrder": false,
      "items": { "$ref": "#/definitions/BgpPeer" },
      "maxItems": 2,
      "minItems": 1,
      "type": "array",
      "uniqueItems": true
    },
    "ConnectionId": {
      "anyOf": [
        {
          "relationshipRef": {
            "propertyPath": "/properties/ConnectionId",
            "typeName": "AWS::DirectConnect::Connection"
          }
        },
        {
          "relationshipRef": {
            "propertyPath": "/properties/ConnectionArn",
            "typeName": "AWS::DirectConnect::Connection"
          }
        },
        {
          "relationshipRef": {
            "propertyPath": "/properties/LagId",
            "typeName": "AWS::DirectConnect::Lag"
          }
        },
        {
          "relationshipRef": {
            "propertyPath": "/properties/LagArn",
            "typeName": "AWS::DirectConnect::Lag"
          }
        }
      ],
      "description": "The ID or ARN of the connection or LAG.",
      "pattern": "^((arn:aws[a-z-]*:directconnect:[a-z0-9-]+:[0-9]{12}:(dxcon/dxcon|dxlag/dxlag))|dx(con|lag))-[a-z0-9A-Z]{8,21}$",
      "type": "string"
    },
    "DirectConnectGatewayId": {
      "anyOf": [
        {
          "relationshipRef": {
            "propertyPath": "/properties/DirectConnectGatewayId",
            "typeName": "AWS::DirectConnect::DirectConnectGateway"
          }
        },
        {
          "relationshipRef": {
            "propertyPath": "/properties/DirectConnectGatewayArn",
            "typeName": "AWS::DirectConnect::DirectConnectGateway"
          }
        }
      ],
      "description": "The ID or ARN of the Direct Connect gateway.",
      "pattern": "^(arn:aws[a-z-]*:directconnect::[0-9]{12}:dx-gateway/)?[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",
      "type": "string"
    },
    "EnableSiteLink": {
      "description": "Indicates whether to enable or disable SiteLink.",
      "type": "boolean"
    },
    "Mtu": {
      "description": "The maximum transmission unit (MTU), in bytes. The supported values are 1500 and 9001. The default value is 1500.",
      "type": "integer"
    },
    "Tags": {
      "description": "The tags associated with the private virtual interface.",
      "insertionOrder": false,
      "items": { "$ref": "#/definitions/Tag" },
      "minItems": 1,
      "type": "array",
      "uniqueItems": true
    },
    "VirtualGatewayId": {
      "description": "The ID or ARN of the virtual private gateway.",
      "pattern": "^(arn:aws[a-z-]*:ec2:[a-z0-9-]+:[0-9]{12}:vpn-gateway/)?vgw-[a-zA-Z0-9]{8,32}$",
      "type": "string"
    },
    "VirtualInterfaceArn": {
      "description": "The ID of the virtual interface.",
      "pattern": "^arn:aws[a-z-]*:directconnect:[a-z0-9-]+:[0-9]{12}:dxvif/dxvif-[a-z0-9]{8}$",
      "type": "string"
    },
    "VirtualInterfaceId": {
      "description": "The ID of the virtual interface.",
      "pattern": "^dxvif-[a-z0-9]{8}$",
      "type": "string"
    },
    "VirtualInterfaceName": {
      "description": "The name of the virtual interface assigned by the customer network. The name has a maximum of 100 characters. The following are valid characters: a-z, 0-9 and a hyphen (-).",
      "pattern": "^[\\w \\-_,\\/]{1,100}$",
      "type": "string"
    },
    "Vlan": {
      "description": "The ID of the VLAN.",
      "maximum": 4095,
      "minimum": 0,
      "type": "integer"
    }
  },
  "propertyTransform": {
    "/properties/ConnectionId": "$lowercase($substringAfter(ConnectionId, \"/\"))",
    "/properties/DirectConnectGatewayId": "$substringAfter(DirectConnectGatewayId, \"/\")",
    "/properties/VirtualGatewayId": "$lowercase($substringAfter(VirtualGatewayId, \"/\"))"
  },
  "readOnlyProperties": [
    "/properties/BgpPeers/*/BgpPeerId",
    "/properties/VirtualInterfaceArn",
    "/properties/VirtualInterfaceId"
  ],
  "replacementStrategy": "delete_then_create",
  "required": ["BgpPeers", "ConnectionId", "VirtualInterfaceName", "Vlan"],
  "sourceUrl": "https://github.com/aws-cloudformation/aws-cloudformation-rpdk.git",
  "tagging": {
    "cloudFormationSystemTags": true,
    "permissions": ["directconnect:TagResource", "directconnect:UntagResource"],
    "tagOnCreate": true,
    "tagProperty": "/properties/Tags",
    "tagUpdatable": true,
    "taggable": true
  },
  "typeName": "AWS::DirectConnect::PrivateVirtualInterface",
  "writeOnlyProperties": ["/properties/AllocatePrivateVirtualInterfaceRoleArn"]
}
